---
title: "HAR Machine Learning"
author: "Kennex Razon"
date: "December 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(caret)
```

## The HAR Dataset
We start with the dataset. 

Velloso, E.; Bulling, A.; Gellersen, H.; Ugulino, W.; Fuks, H. Qualitative Activity Recognition of Weight Lifting Exercises. Proceedings of 4th International Conference in Cooperation with SIGCHI (Augmented Human '13) . Stuttgart, Germany: ACM SIGCHI, 2013.

Read more: http://groupware.les.inf.puc-rio.br/har#dataset#ixzz5Ycr9NiOI

We initially try to use all variables to try a generalized linear model. And we'll fail horribly when we run the commented code. turns out there are columns in our dataframe that only have values every so often. Also there are a lot of strings that are not translatable to numeric such as `#Div/0!` and `NA`. We'll automatically remove them from reading.

We'll look for those columns first then, subset the original `df` to `df1`. 
```{r har}
df <- read.csv(file="D:/PraticalMachineLearning/PracticalMachineLearningRepo/trunk/pml-training.csv", header=TRUE, sep=",",na.strings=c("NA","#DIV/0!",""))
#df <- read.csv(file="C:/Users/DELL/Documents/PracticalMachineLearningRepo/trunk/pml-training.csv", header=TRUE, sep=",")
#a <- grep("avg|max|min|var|amplitude|skewness|total|std|kurtosis|classe",names(df),value=TRUE)
df1 <- df
```
### Clean the data
One of our motivations for subsetting data this way is to remove the NAs and irrelevant data. So we'll do that on our subsetted `df1` and store it in `df2`. Then we'll be left with:

```{r df1}
df1 <- df1[,(colSums(is.na(df1)) == 0)]
df1 <- df1[,7:ncol(df1)]
#str(df2[b])
zeroVar <- nearZeroVar(df1, saveMetrics=TRUE)
#df2 <- myTraining[,zeroVar$df2==FALSE]
df2 <- df1[,zeroVar$nzv == FALSE]
```

Now we split the data into a training and testing set. 
```{r fitting}

trainDf<-createDataPartition(y=df2$classe,p=0.75,list=FALSE)
training <- df2[trainDf,]
testing <- df2[-trainDf,]

trainingData <- training[,1:length(names(training))-1]
trainingClass <- training[,length(names(training))]

set.seed(2)
```
### Classify

The training data is used to create a model.

```{r pressure, echo=FALSE}
modelFit <- train(classe ~ .,data=df2, method = 'cforest')
modelFit
#plot(pressure)
```

### Trying different resampling methods
```{r}
modelFit_cv <- train(trainingData,trainingClass,method = 'cforest', trControl = trainControl(method = "cv"))
modelFit_cv
```

### Using Bootstrapping
```{r}
modelFit_oob <- train(trainingData,trainingClass,method = 'cforest', trControl = trainControl(method = "oob"))
modelFit_oob
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
