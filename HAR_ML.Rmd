---
title: "HAR Machine Learning"
author: "Kennex Razon"
date: "December 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(caret)
```

## The HAR Dataset
We start with the dataset. 

Velloso, E.; Bulling, A.; Gellersen, H.; Ugulino, W.; Fuks, H. Qualitative Activity Recognition of Weight Lifting Exercises. Proceedings of 4th International Conference in Cooperation with SIGCHI (Augmented Human '13) . Stuttgart, Germany: ACM SIGCHI, 2013.

Read more: http://groupware.les.inf.puc-rio.br/har#dataset#ixzz5Ycr9NiOI

We initially try to use all variables to try a generalized linear model. And we'll fail horribly when we run the commented code. turns out there are columns in our dataframe that only have values every so often. These values are max,min, amplitude, var and avg. So we'll try and use those first.

We'll look for those columns first then, subset the original `df`.
```{r har}
 df <- read.csv(file="D:/PraticalMachineLearning/PracticalMachineLearningRepo/trunk/pml-training.csv", header=TRUE, sep=",")
#D:\PraticalMachineLearning\PracticalMachineLearningRepo\trunk

#a <- grep("avg|max|min|var|amplitude|skewness|total|std|kurtosis|classe",names(df),value=TRUE)
a <- grep("avg|max|min|var|amplitude|std|classe",names(df),value=TRUE)
df1 <- df[a]



#a <- subset(df, new_window != "yes")
#df1 <- a

```

One of our motivations for subsetting data this way is to remove the NAs. So we'll do that on our subsetted `df1` and store it in `df2`. Then we'll be left with:

```{r df1}
df2 <- df1[complete.cases(df1), ]
b <- grep("max|min|amplitude",names(df2),value=TRUE)
df2[b] <- data.frame(lapply(df2[b], function(x) { gsub("#DIV/0!", "NA", x)}))
#df2[b] <- data.frame(lapply(df2[b], function(x) { gsub("\"", "", x)}))
df2[b] <- data.frame(lapply(df2[b],as.numeric))
#str(df2[b])

```

Now we try again training and testing again. Still dirty datasets. We take out the strings.
A lot of coding
```{r fitting}

trainDf<-createDataPartition(y=df2$classe,p=0.75,list=FALSE)
training <- df2[trainDf,]
testing <- df2[-trainDf,]

#preObj <- preProcess(training[,-65],method=c("center","scale"))

#trainingData<-training[,1:64]
#trainingClasses<-training[,65]
#str(trainingData)

set.seed(2)
#modelFit <- train(classe ~ .,data=training, method="cforest") # takes about 3 hrs to run
#modelFit
```
## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
modelFit <- train(classe ~ .,data=training, method = 'cforest')
modelFit
#plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
